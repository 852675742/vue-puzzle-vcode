!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports["vue-puzzle-vcode"]=n():t["vue-puzzle-vcode"]=n()}(window,function(){return function(t){var n={};function e(i){if(n[i])return n[i].exports;var o=n[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,i){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:i})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(e.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(i,o,function(n){return t[n]}.bind(null,o));return i},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=1)}([function(t,n,e){var i=e(3);"string"==typeof i&&(i=[[t.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};e(5)(i,o);i.locals&&(t.exports=i.locals)},function(t,n,e){t.exports=e(7)},function(t,n,e){"use strict";var i=e(0);e.n(i).a},function(t,n,e){(t.exports=e(4)(!1)).push([t.i,".vue-puzzle-vcode {\n  position: fixed;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  background-color: rgba(0, 0, 0, 0.3);\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n          justify-content: center;\n  z-index: 999;\n  opacity: 0;\n  pointer-events: none;\n  -webkit-transition: opacity 200ms;\n  transition: opacity 200ms;\n}\n.vue-puzzle-vcode.show {\n  opacity: 1;\n  pointer-events: auto;\n}\n.vue-auth-box {\n  padding: 20px;\n  background: #fff;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  border-radius: 3px;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);\n}\n.vue-auth-box .auth-body {\n  position: relative;\n  height: 160px;\n  overflow: hidden;\n  border-radius: 3px;\n}\n.vue-auth-box .auth-body .loading-box {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  background-color: rgba(0, 0, 0, 0.4);\n  z-index: 2;\n  opacity: 1;\n  -webkit-transition: opacity 200ms;\n  transition: opacity 200ms;\n}\n.vue-auth-box .auth-body .loading-box.hide {\n  opacity: 0;\n}\n.vue-auth-box .auth-body .info-box {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 24px;\n  line-height: 24px;\n  text-align: center;\n  overflow: hidden;\n  font-size: 13px;\n  background-color: #83ce3f;\n  opacity: 0;\n  -webkit-transform: translateY(24px);\n          transform: translateY(24px);\n  -webkit-transition: all 200ms;\n  transition: all 200ms;\n  color: #fff;\n}\n.vue-auth-box .auth-body .info-box.show {\n  opacity: 0.95;\n  -webkit-transform: translateY(0);\n          transform: translateY(0);\n}\n.vue-auth-box .auth-body .info-box.fail {\n  background-color: #ce3f83;\n}\n.vue-auth-box .auth-body .auth-canvas2 {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 70px;\n  height: 100%;\n  z-index: 2;\n}\n.vue-auth-box .auth-control .range-box {\n  position: relative;\n  width: 100%;\n  height: 50px;\n  background-color: #eef1f8;\n  margin-top: 20px;\n  border-radius: 3px;\n  box-shadow: 0 0 8px rgba(240, 240, 240, 0.6) inset;\n}\n.vue-auth-box .auth-control .range-box .range-text {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n  font-size: 14px;\n  color: #b7bcd1;\n}\n.vue-auth-box .auth-control .range-box .range-slider {\n  position: absolute;\n  height: 100%;\n  width: 50px;\n  background-color: rgba(106, 160, 255, 0.8);\n  border-radius: 3px;\n}\n.vue-auth-box .auth-control .range-box .range-slider .range-btn {\n  position: absolute;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n          justify-content: center;\n  right: 0;\n  width: 50px;\n  height: 50px;\n  background-color: #fff;\n  border-radius: 3px;\n  box-shadow: 0 0 4px #ccc;\n  cursor: pointer;\n}\n.vue-auth-box .auth-control .range-box .range-slider .range-btn > div {\n  width: 0;\n  height: 40%;\n  -webkit-transition: all 200ms;\n  transition: all 200ms;\n  border: solid 1px #6aa0ff;\n}\n.vue-auth-box .auth-control .range-box .range-slider .range-btn > div:nth-child(2) {\n  margin: 0 4px;\n}\n.vue-auth-box .auth-control .range-box .range-slider .range-btn:hover > div:first-child,\n.vue-auth-box .auth-control .range-box .range-slider .range-btn.isDown > div:first-child {\n  border: solid 4px transparent;\n  height: 0;\n  border-right-color: #6aa0ff;\n}\n.vue-auth-box .auth-control .range-box .range-slider .range-btn:hover > div:nth-child(2),\n.vue-auth-box .auth-control .range-box .range-slider .range-btn.isDown > div:nth-child(2) {\n  border-width: 3px;\n  height: 0;\n  border-radius: 3px;\n  margin: 0 6px;\n  border-right-color: #6aa0ff;\n}\n.vue-auth-box .auth-control .range-box .range-slider .range-btn:hover > div:nth-child(3),\n.vue-auth-box .auth-control .range-box .range-slider .range-btn.isDown > div:nth-child(3) {\n  border: solid 4px transparent;\n  height: 0;\n  border-left-color: #6aa0ff;\n}\n",""])},function(t,n,e){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map(function(n){var e=function(t,n){var e=t[1]||"",i=t[3];if(!i)return e;if(n&&"function"==typeof btoa){var o=(s=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),r=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[e].concat(r).concat([o]).join("\n")}var s;return[e].join("\n")}(n,t);return n[2]?"@media "+n[2]+"{"+e+"}":e}).join("")},n.i=function(t,e){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},o=0;o<this.length;o++){var r=this[o][0];null!=r&&(i[r]=!0)}for(o=0;o<t.length;o++){var s=t[o];null!=s[0]&&i[s[0]]||(e&&!s[2]?s[2]=e:e&&(s[2]="("+s[2]+") and ("+e+")"),n.push(s))}},n}},function(t,n,e){var i,o,r={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===o&&(o=i.apply(this,arguments)),o}),a=function(t){var n={};return function(t,e){if("function"==typeof t)return t();if(void 0===n[t]){var i=function(t,n){return n?n.querySelector(t):document.querySelector(t)}.call(this,t,e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}n[t]=i}return n[t]}}(),l=null,h=0,u=[],c=e(6);function d(t,n){for(var e=0;e<t.length;e++){var i=t[e],o=r[i.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++)o.parts[s](i.parts[s]);for(;s<i.parts.length;s++)o.parts.push(x(i.parts[s],n))}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(x(i.parts[s],n));r[i.id]={id:i.id,refs:1,parts:a}}}}function f(t,n){for(var e=[],i={},o=0;o<t.length;o++){var r=t[o],s=n.base?r[0]+n.base:r[0],a={css:r[1],media:r[2],sourceMap:r[3]};i[s]?i[s].parts.push(a):e.push(i[s]={id:s,parts:[a]})}return e}function p(t,n){var e=a(t.insertInto);if(!e)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===t.insertAt)i?i.nextSibling?e.insertBefore(n,i.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),u.push(n);else if("bottom"===t.insertAt)e.appendChild(n);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=a(t.insertAt.before,e);e.insertBefore(n,o)}}function v(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var n=u.indexOf(t);n>=0&&u.splice(n,1)}function b(t){var n=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return e.nc}();i&&(t.attrs.nonce=i)}return g(n,t.attrs),p(t,n),n}function g(t,n){Object.keys(n).forEach(function(e){t.setAttribute(e,n[e])})}function x(t,n){var e,i,o,r;if(n.transform&&t.css){if(!(r="function"==typeof n.transform?n.transform(t.css):n.transform.default(t.css)))return function(){};t.css=r}if(n.singleton){var s=h++;e=l||(l=b(n)),i=y.bind(null,e,s,!1),o=y.bind(null,e,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=function(t){var n=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",g(n,t.attrs),p(t,n),n}(n),i=function(t,n,e){var i=e.css,o=e.sourceMap,r=void 0===n.convertToAbsoluteUrls&&o;(n.convertToAbsoluteUrls||r)&&(i=c(i));o&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var s=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,e,n),o=function(){v(e),e.href&&URL.revokeObjectURL(e.href)}):(e=b(n),i=function(t,n){var e=n.css,i=n.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}.bind(null,e),o=function(){v(e)});return i(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;i(t=n)}else o()}}t.exports=function(t,n){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(n=n||{}).attrs="object"==typeof n.attrs?n.attrs:{},n.singleton||"boolean"==typeof n.singleton||(n.singleton=s()),n.insertInto||(n.insertInto="head"),n.insertAt||(n.insertAt="bottom");var e=f(t,n);return d(e,n),function(t){for(var i=[],o=0;o<e.length;o++){var s=e[o];(a=r[s.id]).refs--,i.push(a)}t&&d(f(t,n),n);for(o=0;o<i.length;o++){var a;if(0===(a=i[o]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete r[a.id]}}}};var m,w=(m=[],function(t,n){return m[t]=n,m.filter(Boolean).join("\n")});function y(t,n,e,i){var o=e?"":i.css;if(t.styleSheet)t.styleSheet.cssText=w(n,o);else{var r=document.createTextNode(o),s=t.childNodes;s[n]&&t.removeChild(s[n]),s.length?t.insertBefore(r,s[n]):t.appendChild(r)}}},function(t,n){t.exports=function(t){var n="undefined"!=typeof window&&window.location;if(!n)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var e=n.protocol+"//"+n.host,i=e+n.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,n){var o,r=n.trim().replace(/^"(.*)"$/,function(t,n){return n}).replace(/^'(.*)'$/,function(t,n){return n});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(r)?t:(o=0===r.indexOf("//")?r:0===r.indexOf("/")?e+r:i+r.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},function(t,n,e){"use strict";e.r(n);var i=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{class:["vue-puzzle-vcode",{show:t.show}],on:{mousedown:t.onCloseMouseDown,mouseup:t.onCloseMouseUp}},[e("div",{staticClass:"vue-auth-box",on:{mousedown:function(t){t.stopPropagation()}}},[e("div",{staticClass:"auth-body"},[e("canvas",{ref:"canvas1",style:"width:"+t.canvasWidth+"px;height:"+t.canvasHeight+"px",attrs:{width:t.canvasWidth,height:t.canvasHeight}}),t._v(" "),e("canvas",{ref:"canvas2",staticClass:"auth-canvas2",style:"width:70px;height:"+t.canvasHeight+"px;transform:translateX("+(t.styleWidth-(t.styleWidth-50)/(t.canvasWidth-50)*20-50)+"px)",attrs:{width:"70",height:t.canvasHeight}}),t._v(" "),e("div",{class:["loading-box",{hide:!t.loading}]}),t._v(" "),e("div",{class:["info-box",{show:t.infoBoxShow},{fail:t.infoBoxFail}]},[t._v(t._s(t.infoText))])]),t._v(" "),e("div",{staticClass:"auth-control"},[e("div",{staticClass:"range-box"},[e("div",{staticClass:"range-text"},[t._v("拖动滑块完成拼图")]),t._v(" "),e("div",{ref:"range-slider",staticClass:"range-slider",style:"width:"+t.styleWidth+"px"},[e("div",{class:["range-btn",{isDown:t.mouseDown}],on:{mousedown:function(n){t.onRangeMouseDown(n)}}},[e("div"),t._v(" "),e("div"),t._v(" "),e("div")])])])])])])};i._withStripped=!0;var o={data:()=>({canvasWidth:310,canvasHeight:160,mouseDown:!1,startWidth:50,startX:0,newX:0,pinX:0,pinY:0,loading:!0,isCanSlide:!1,error:!1,infoBoxShow:!1,infoText:"",infoBoxFail:!1,timer1:null,closeDown:!1}),props:{show:{type:Boolean,default:!1},imgs:{type:Array,required:!0,defalut:()=>[]},successText:{type:String,default:"验证通过！"},failText:{type:String,default:"验证失败，请重试"}},mounted(){document.addEventListener("mousemove",this.onRangeMouseMove,!1),document.addEventListener("mouseup",this.onRangeMouseUp,!1)},beforeDestroy(){clearTimeout(this.timer1),document.removeEventListener("mousemove",this.onRangeMouseMove,!1),document.removeEventListener("mouseup",this.onRangeMouseUp,!1)},watch:{show(t){console.log("watch",t),t&&this.reset()}},computed:{styleWidth(){const t=this.startWidth+this.newX-this.startX;return t<50?50:t>310?310:t}},methods:{onClose(){this.mouseDown||(clearTimeout(this.timer1),this.$emit("onClose"))},onCloseMouseDown(){this.closeDown=!0},onCloseMouseUp(){this.closeDown&&this.onClose(),this.closeDown=!1},onRangeMouseDown(t){this.isCanSlide&&(this.mouseDown=!0,this.startWidth=this.$refs["range-slider"].clientWidth,this.newX=t.clientX,this.startX=t.clientX)},onRangeMouseMove(t){this.mouseDown&&(this.newX=t.clientX)},onRangeMouseUp(t){this.mouseDown&&(this.mouseDown=!1,this.submit())},init(){this.loading=!0;const t=this.$refs.canvas1,n=this.$refs.canvas2,e=t.getContext("2d"),i=n.getContext("2d"),o=new Image;e.clearRect(0,0,this.canvasWidth,this.canvasHeight),i.clearRect(0,0,70,this.canvasHeight),this.pinX=this.getRandom(60,this.canvasWidth-90),this.pinY=this.getRandom(20,this.canvasHeight-90),o.crossOrigin="Anonymous",o.onload=(()=>{e.save(),this.paintBrick(e),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowColor="#000",e.shadowBlur=8,e.fill(),e.clip(),e.drawImage(o,0,0,this.canvasWidth,this.canvasHeight),e.globalCompositeOperation="source-atop",this.paintBrick(e),e.arc(this.pinX+35,this.pinY+35,80,0,2*Math.PI,!0),e.closePath(),e.shadowColor="rgba(255, 255, 255, .8)",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=10,e.fillStyle="#ffffaa",e.fill();const t=e.getImageData(this.pinX-3,this.pinY-20,this.pinX+75,this.pinY+50);i.putImageData(t,0,this.pinY-20),e.restore(),e.clearRect(0,0,this.canvasWidth,this.canvasHeight),e.save(),this.paintBrick(e),e.globalAlpha=.8,e.fillStyle="#ffffff",e.fill(),e.restore(),e.save(),e.globalCompositeOperation="source-atop",this.paintBrick(e),e.arc(this.pinX+35,this.pinY+35,80,0,2*Math.PI,!0),e.shadowColor="#000",e.shadowOffsetX=2,e.shadowOffsetY=2,e.shadowBlur=16,e.fill(),e.restore(),e.save(),e.globalCompositeOperation="destination-over",e.drawImage(o,0,0,this.canvasWidth,this.canvasHeight),e.restore(),this.loading=!1}),o.onerror=(()=>{console.log("onError了"),this.loading=!0,this.isCanSlide=!1,this.error=!0}),o.src=this.imgs[this.getRandom(0,this.imgs.length-1)]},getRandom:(t,n)=>Math.round(Math.random()*(n-t)+t),paintBrick(t){t.beginPath(),t.moveTo(this.pinX,this.pinY),t.lineTo(this.pinX+15,this.pinY),t.bezierCurveTo(this.pinX+15,this.pinY-20,this.pinX+15+20,this.pinY-20,this.pinX+15+20,this.pinY),t.lineTo(this.pinX+15+20+15,this.pinY),t.lineTo(this.pinX+15+20+15,this.pinY+15),t.bezierCurveTo(this.pinX+15+20+15+20,this.pinY+15,this.pinX+15+20+15+20,this.pinY+15+20,this.pinX+15+20+15,this.pinY+15+20),t.lineTo(this.pinX+15+20+15,this.pinY+15+20+15),t.lineTo(this.pinX,this.pinY+15+20+15),t.lineTo(this.pinX,this.pinY+15+20),t.bezierCurveTo(this.pinX+20,this.pinY+15+20,this.pinX+20,this.pinY+15,this.pinX,this.pinY+15),t.lineTo(this.pinX,this.pinY)},submit(){console.log("success,",this.pinX,this.styleWidth,this.pinX-this.styleWidth+50),Math.abs(this.pinX-this.styleWidth+50)<10?(this.infoText=this.successText,this.infoBoxFail=!1,this.infoBoxShow=!0,this.isCanSlide=!1,clearTimeout(this.timer1),this.timer1=setTimeout(()=>{this.$emit("successCallback")},800)):(this.infoText=this.failText,this.infoBoxFail=!0,this.infoBoxShow=!0,this.isCanSlide=!1,this.$emit("failCallback"),clearTimeout(this.timer1),this.timer1=setTimeout(()=>{this.reset()},800))},reset(){this.infoBoxFail=!1,this.infoBoxShow=!1,this.isCanSlide=!0,this.startWidth=50,this.startX=0,this.newX=0,this.init()}}};e(2);var r=function(t,n,e,i,o,r,s,a){var l,h="function"==typeof t?t.options:t;if(n&&(h.render=n,h.staticRenderFns=e,h._compiled=!0),i&&(h.functional=!0),r&&(h._scopeId="data-v-"+r),s?(l=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(s)},h._ssrRegister=l):o&&(l=a?function(){o.call(this,this.$root.$options.shadowRoot)}:o),l)if(h.functional){h._injectStyles=l;var u=h.render;h.render=function(t,n){return l.call(n),u(t,n)}}else{var c=h.beforeCreate;h.beforeCreate=c?[].concat(c,l):[l]}return{exports:t,options:h}}(o,i,[],!1,null,null,null);r.options.__file="src/app.vue";var s=r.exports;n.default=s}])});